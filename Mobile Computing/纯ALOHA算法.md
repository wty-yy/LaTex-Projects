## 纯ALOHA算法

### ALOHA算法概述

纯ALOHA算法(Additive Links On-line Hawaii Area)是一种用于共享信道网络的简单的随机访问协议，它最初是在20世纪70年代开发出来的。ALOHA算法允许多个终端设备共享一个通信信道，每个终端设备都可以在需要发送数据时随机选择一个时间窗口发送数据。

在纯ALOHA算法中，如果两个或多个终端设备同时尝试发送数据，那么它们的数据包就会在信道上发生碰撞，导致数据包丢失。在发生碰撞后，终端设备会随机选择一个时间窗口再次尝试发送数据。

纯ALOHA算法非常简单，但是它的效率比较低，因为会出现很多的碰撞和重传，导致信道带宽的利用率不高。后来，人们对ALOHA算法进行了改进，例如使用时隙ALOHA和轮询ALOHA等技术，以提高信道的利用率和网络的吞吐量。

### 基本原理

在ALOHA算法中，每个终端设备都可以在任何时间发送数据包，但如果多个设备同时尝试发送数据，就会发生冲突，导致数据包丢失。为了避免这种冲突，ALOHA算法引入了随机时间窗口的概念。

**随机时间窗口**指的是每个终端设备在发送数据包前等待的随机时间段。在这个时间段内，设备会等待一段随机的时间，然后再尝试发送数据包。由于每个设备的随机时间是不同的，因此可以减少多个设备同时发送数据包的概率，从而降低冲突的发生率。如果数据包发送失败，则设备会在下一个随机时间窗口再次尝试发送。

具体的实现步骤如下：

1. 当一个终端设备有数据要发送时，它会等待一段随机时间窗口后开始发送数据。

2. 如果在该时间窗口内没有其他终端设备发送数据，那么这个终端设备的数据就能够成功传输到接收方。

3. 如果在该时间窗口内有其他终端设备也在发送数据，那么它们的数据包就会在信道上发生碰撞，导致数据包丢失。

4. 发生碰撞后，每个终端设备都会等待一段随机时间窗口后再次尝试发送数据。

纯ALOHA算法的优点是实现简单，适用于低负载的情况，但是缺点也比较明显，即容易出现碰撞和重传，导致信道的利用率不高。

### 吞吐率计算

**吞吐率**是指在给定的时间内成功传输数据包的比例。

在ALOHA算法中，当一个设备要发送一个数据包时，它会直接发送出去，而不会事先检查信道是否被其他设备占用。如果发送的数据包与其他设备发送的数据包产生冲突，那么这些数据包就会被丢弃。因此，ALOHA算法的吞吐率受到信道冲突的影响。

假设设备的传输速率为 $G$ 包/秒，如果设备在每个时隙内都以独立相同的概率 $p$ 传输数据包，那么设备在一个时隙内不进行数据传输的概率为 $(1-p)$，并且在同一个时隙内没有其他设备传输数据包的概率为 $(1-p)^{N-1}$，其中N是同时存在的设备数量。
因此，设备在一个时隙内发生碰撞的概率为 $1-(1-p)^{N-1}$，这可以看作是在 $N-1$ 个设备中选择一个进行传输的概率为 $p$ 的二项式分布。当设备以相同的概率 $p$ 进行传输时，每个设备发生碰撞的概率相等，因此碰撞的概率是所有设备发生碰撞概率的总和。因此，设备在一个时隙内发生碰撞的概率可以表示为：
$$
p_c = Np(1-p)^{N-1}
$$
假设设备的平均传输速率为 $G$ 包/秒，那么在一个时隙内，设备平均会传输 $Gp$ 个数据包。因此，设备在一个时隙内成功传输的数据包数量为 $Gp(1-p_c)$ 。在一个时隙内传输的总数据包数量为 $GNp$，因此在一个时隙内的吞吐率为 $Gp(1-p_c)/GNp = p(1-p_c)$。
当设备数量 $N$ 很大时，可以将 $(1-p)^{N-1}$ 在 $p=1/N$ 处泰勒展开，得到 $(1-p)^{N-1}$ 约等于 $e^{-p(N-1)}$ 约等于 $e\frac{-G(N-1)}{G}e^{-2G}$ 因此，设备在一个时隙内发生碰撞的概率为 $p_c$ 约等于$Np e^{-2G}$。将其代入吞吐率的公式中可以得到:
$$
吞吐率 = p(1-P_c) \approx p(1-Ne^{-2G}p) = p - Ne^{-2G}p^2
$$
因此，设备在一个时隙内发生碰撞的概率为 $P_c$ 约等于 $Np\cdot e^{-2G}$。为了使吞吐率最大化，需要对 $p$ 求导，并将其置为0，可以得到 $p_{opt} = 1/N$。将其代入吞吐率公式中，可以得到:
$$
吞吐率_{opt} =\frac{1}{N}e^{-2G}
$$

因此，Aloha协议的最大吞吐率为 $\frac{1}{N}e^{-2G}$ ，其中 $N$ 是设备数量，$G$ 是设备平均传输.

### 时间复杂度

纯ALOHA算法是一种随机接入协议，标签在发送数据时随机选择一个时间窗口发送数据，如果发送冲突，则在一段时间后再次随机选择时间窗口发送数据。其时间复杂度可以通过以下方式推导：
假设有 $n$ 个标签，每个标签以概率 $p$ 在每个时间窗口内发送数据，则平均每个时间窗口内有 $np$ 个标签发送数据。如果两个或更多标签在同一时间窗口内发送数据，则发生冲突。
假设标签在冲突后等待一个随机时间再次发送数据，等待时间为 $T$，以概率 $p$ 发送数据，则有 $np(1-p)^{n-1}$ 个标签在一个时间窗口内成功发送数据。因此，标签发送成功的平均吞吐量为：
$$
S = np(1-p)^{n-1}
$$
在求解时间复杂度时，我们通常关注的是算法的最坏情况，即在所有标签都同时发送数据的情况下，需要等待多长时间才能解决冲突。
当所有标签都同时发送数据时，平均每个时间窗口内有 $n$ 个标签发送数据，因此有 $n$ 个标签会在同一时间窗口内发送数据，导致冲突。标签等待随机时间T后再次发送数据，如果仍然发生冲突，则需要等待另一个随机时间。这个过程可以看作是一个等待时间的几何分布，其期望等待时间为：
$$
E[T] = \frac{1}{2np}
$$
因此，当所有标签都同时发送数据时，纯ALOHA算法解决冲突的平均时间复杂度为：$O(n)$，即时间复杂度与标签数量呈线性关系。

### 通信复杂度

纯ALOHA算法的通信复杂度是指在解决冲突之前需要发送的数据包数量。在最坏情况下，即所有标签都同时发送数据的情况下，每个标签需要等待随机时间后再次发送数据，如果仍然发生冲突，则需要再等待另一个随机时间。因此，在解决冲突之前，每个标签可能需要发送多次数据包才能成功传输。
假设标签在冲突后等待一个随机时间再次发送数据，等待时间为 $T$，以概率 $p$ 发送数据，则有 $np(1-p)^{n-1}$ 个标签在一个时间窗口内成功发送数据。因此，在最坏情况下，所有标签都同时发送数据，每个标签都需要发送 $1/np(1-p)^{n-1}$ 个数据包才能成功传输，即：
$$
C = \frac{n}{p (1 - p)^{n-1}}
$$

因此，纯ALOHA算法的通信复杂度也是与标签数量呈线性关系。在大规模的标签数量下，纯ALOHA算法的通信复杂度会变得非常高，因此需要使用其他更有效的防冲突算法。